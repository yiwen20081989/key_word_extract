电脑报：次品闪存内幕揭秘

　　一位技术主管的来信：我所了解的次品闪存内幕 
　　电脑报记者 李好宇
　　本报第40期《次品闪存的非正常流向调查报告》刊出后，得到业界内外的广泛关注。不久前，记者接到一封神秘邮件。发信人自称是某闪存IC厂的负责人，熟悉闪存扩容的具体操作，愿意为读者揭开闪存行业不为人知的秘密。带着几分好奇与疑虑，记者进行了深入查访。 
　　主控厂商才是万恶之源？
　　发信人王祖宏(化名)此前是国内一家中等规模主控芯片生产商的CTO(首席技术官)，负责IC的研发及测试。他的客户都是一些深圳小厂，即人们常说的山寨厂。“我们的IC过不了ESD抗静电标准，所以入不了大厂法眼”，王祖宏笑称.
　　虽然接不到名厂大单，却也从来不为生计发愁。依靠庞大的山寨市场，每个月走300万～400万片的IC不成问题。“为什么能走这么多？因为客户看中的是IC的扩容能力。为了走量，主控厂商也做了不少‘功课’”。
　　王先生口中所谓的“功课”，是指一些主控厂商在IC设计时便预留了扩容后门，允许利用漏洞进行扩容。更有甚者，一些IC厂商自行研发扩容软件，与自家主控芯片配套出售。“大家的货都差不多，就靠软件赚钱。一个普通主控能卖3.2元，而这种可扩容的主控(附带软件)要卖到4.5元”。做这一行的有个不成文规定：所有可扩容的主控都是不单卖的，一定要捆绑软件。采取这种捆绑销售模式，除了可以牟取暴利以外，也是希望借助这些特殊软件打开IC市场，拓宽渠道。虽然劣质闪存成本支出比正常的要多，但通过扩容后的闪存因为达到的容量“倍增”后牟取的暴利，远比这个支出大。
　　闪存组成：闪存主要是由闪存芯片、主控芯片、晶振、PCB板等部件组成的。其中主控芯片相当于闪存的“灵魂”，它控制着闪存的工作。主控厂商就是为闪存提供主控芯片的一方。
　　主控厂商与代理商或闪存厂商签订了保密协议后，贷款交接时会附赠这个可扩容的量产工具。该工具检测到闪存后，会自动生成一个6位的Key并禁止进入量产界面。主控厂商正是通过限制Key的使用次数来实现软件与IC的搭配。一个客户如果从主控厂商这里购买了2000片IC的话，一般会获得一个允许使用2200次的Key。达到规定次数之后，软件就会被锁定。“如果还想继续使用，需要向主控厂商购买，就像手机充值那样”。
　　“除了扩容以外，这种软件还有一个非常重要的作用”。王祖宏认为，另一个“亮点”也许才是山寨厂商们趋之若鹜的主要原因。如果说扩容是从小到大的量变过程，那么这个软件还可以神奇地实现“从无到有”。“任何一个闪存在量产时都需要格式化，在默认ECC为0(较严格)的情况下，坏块过多就会报错，量产也就无法进行，闪存等于废掉了”。而这款软件可以忽略闪存芯片的质量进行格式化操作。这种特殊的量产工具允许用户自行调节ECC。“在ECC3模式下，每个扇区3个位置的错误也将被忽略”。
　　在这个量产工具的帮助下，坏块再多的黑片也可以轻松地通过格式化，从而进入量产。对于劣质闪存厂商来说，可将一些黑片变废为宝。但对购买了这种闪存的消费者来说，不仅可能会造成读写障碍，更会造成丢失重要数据、文件。
　　闪存这样被“撑大”：扩容过程中最核心的就是scsi23/25命令，简单地说就是让固件在进行超容量读写的时候忽略写操作。闪存明明没写，却告诉系统写成功了。这也是扩容后经常出现一些文件无法读取的原因。


